man mutate
manual
knitr::opts_chunk$set(echo = TRUE)
install.packages("knitr")
install.packages("knitr")
install.packages("knitr")
install.packages("knitr")
knitr::opts_chunk$set(echo = TRUE)
file = "dpt2022_txt.zip"
if(!file.exists(file)){
download.file("https://www.insee.fr/fr/statistiques/fichier/7633685/dpt2022_csv.zip",
destfile=file)
}
unzip(file)
library(tidyverse)
FirstNames <- read_delim("dpt2022.csv",delim=";")
setwd("~/")
library(readr)
annual_number_of_deaths_by_cause <- read_csv("L3 MIAGE/annual-number-of-deaths-by-cause.csv")
View(annual_number_of_deaths_by_cause)
setwd("C:/Users/33785/projetModelStat")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(scales)
annualdeath <- read.csv("../Dataset/annual-number-of-deaths-by-cause.csv", header = TRUE)
governmentEducationExpenditure  <- read.csv("../Dataset/total-government-expenditure-on-education-gdp.csv", header = TRUE)
enrolment_ratio_teritiary_education <- read.csv("../Dataset/enrolment-ratio-teritiary-education.csv", header = TRUE)
waterAccess <- read.csv("../Dataset/water-withdrawals-per-capita.csv")
poptotal <- read.csv("../Dataset/number-of-deaths-per-year.csv")
airPollution <- read.csv("../Dataset/air-pollution.csv", header = TRUE)
cleanWater <- read.csv("../Dataset/share-without-improved-water.csv", header = TRUE)
annualdeath <- annualdeath %>% filter(Code != "");
governmentEducationExpenditure <- governmentEducationExpenditure  %>% filter(Code != "");
waterAccess <- waterAccess %>% filter(Code != "");
exclude <-  c("Entity", "Year")
for (col in names(airPollution)) {
if (!(col %in% exclude)) {
airPollution[[col]] <- round(airPollution[[col]])
}
}
colnames(annualdeath) <- c("Country","Code","Year","Meningitis","Alzheimers disease","Parkinsons disease","Nutritional deficiencies","Malaria",
"Drowning","Interpersonal violence", "Maternal disorders", "HIV AIDS" , "Drug use disorders", "Tuberculosis", "Cardiovascular diseases", "Lower respiratory infections", "Neonatal disorders","Alcohol use disorders", "Self harm", "Exposure to forces of nature", "Diarrheal diseases", "Environmental heat and cold exposure", "Neoplasms", "Conflict and terrorism", "Diabetes mellitus", "Chronic kidney disease", "Poisonings", "Protein energy malnutrition", "Road injuries", "Chronic respiratory diseases", "Cirrhosis and other chronic liver diseases", "Digestive diseases","Fire heat and hot substances","Acute hepatitis", "Measles"
)
colnames(governmentEducationExpenditure) <- c("Country","Code","Year", "GPD spent in Education (%)")
colnames(enrolment_ratio_teritiary_education) <- c("Country","Year","Gender","Age", "Units", "Enrolment ratio (%)")
colnames(waterAccess) <- c("Country","Code", "Year", "Water withdrawal per capita ()")
colnames(poptotal) <- c("Country","Code", "Year","Deaths", "Death_mean")
colnames(airPollution) <- c("Nitrogen oxide (NOx)", "Sulphur dioxide (SO₂)", "Carbon monoxide (CO)", "Organic carbon (OC)", "NMVOCs", "Black carbon (BC)", "Ammonia (NH₃)", "s1", "s2", "s3", "s3", "s4", "s5", "s6", "Country", "Year")
airPollution <- airPollution[, c("Country", "Year", names(airPollution)[-which(names(airPollution) %in% c("Country", "Year"))])]
annualdeath <- select(annualdeath,-Code, -`Interpersonal violence`, -`Fire heat and hot substances`, -`Road injuries`, -`Conflict and terrorism`, -`Exposure to forces of nature`, -`Self harm` , -`Alzheimers disease` , -`Parkinsons disease`, -`Drowning`, -`Maternal disorders`, -`Drug use disorders`, -`Alcohol use disorders` , -`Environmental heat and cold exposure`, -`Poisonings`, -`Neonatal disorders`, -`Nutritional deficiencies` , -`Meningitis`)
governmentEducationExpenditure <- select(governmentEducationExpenditure, -Code)
enrolment_ratio_teritiary_education <- select(enrolment_ratio_teritiary_education, -Units, -Age,)
waterAccess <- select(waterAccess, -Code)
poptotal <- select(poptotal,Country, Year, Deaths)
airPollution <- select(airPollution, -s1, -s2, -s3, -s4, -s5, -s6, -s3.1)
airPollution <- subset(airPollution, !(Country %in% c("Asia", "Europe", "Africa", "World", "High-income countries", "Upper-middle-income countries", "North America", "Lower-middle-income countries", "South America", "Oceania", "Low-income countries", "Gibraltar", "Sint Maarten (Dutch part)", "Cayman Islands")))
Polluants <- rowSums(airPollution[, -(1:2)])
airPollution$Polluants <- Polluants
airPollution <- airPollution[, c("Country", "Year", "Polluants")]
annualdeath$`Infectious diseases` <- annualdeath$`Malaria` + annualdeath$`Tuberculosis` + annualdeath$`HIV AIDS` + annualdeath$`Measles` + annualdeath$`Diarrheal diseases`
annualdeath <- select(annualdeath, Country, Year, `Infectious diseases`)
annualdeath <- annualdeath %>% filter(Year<2011);
governmentEducationExpenditure <- governmentEducationExpenditure  %>% filter(Year<2011) %>%filter(Year>1989);
enrolment_ratio_teritiary_education <- enrolment_ratio_teritiary_education  %>% filter(Year<2011) %>%filter(Year>1989)  %>%filter(Gender == "All genders") ;
waterAccess <- waterAccess %>% filter(Year<2011) %>%filter(Year>1989)
poptotal <- poptotal  %>% filter(Year<2011) %>%filter(Year>1989)
airPollution <- airPollution %>% filter(Year<2011) %>%filter(Year>1989) %>% filter(Polluants > 10000)
cleanWater <- cleanWater %>% filter(Year < 2011) %>% filter(Code != "") %>% filter(!Entity %in% c("Gibraltar", "Sint Maarten (Dutch part)", "Cayman Islands"))
cleanWater <- select(cleanWater, -`Code`)
colnames(cleanWater) <- c("Country", "Year", "Proportion of population unable to access clean water (%)")
cleanWater$`Proportion of population unable to access clean water (%)` <- round((cleanWater$`Proportion of population unable to access clean water (%)`), 2)
governmentEducationExpenditure <- governmentEducationExpenditure %>% group_by(Country) %>% filter(n() > 5) %>% filter(Country != "World")
annualdeath <- annualdeath %>% group_by(Country) %>% filter(n() > 5) %>% filter(Country != "World")
enrolment_ratio_teritiary_education <- enrolment_ratio_teritiary_education %>% group_by(Country) %>% filter(n() > 5) %>% filter(!grepl("^MDG_", Country))
waterAccess <- waterAccess %>% group_by(Country) %>% filter(n() == 5)
annualdeath <- merge(annualdeath, poptotal[, c("Country", "Year", "Deaths")], by = c("Country", "Year"))
annualdeath$`Infectious diseases prop (%)` <- annualdeath$`Infectious diseases` /  annualdeath$Deaths *100
governmentEducationExpenditure_mean <- governmentEducationExpenditure %>%
group_by(Country) %>%
summarise(Mean_GPD_spent = mean(`GPD spent in Education (%)`))
governmentEducationExpenditure_valmax <- governmentEducationExpenditure_mean %>% top_n(5, wt = `Mean_GPD_spent`)
governmentEducationExpenditure_valmin <- governmentEducationExpenditure_mean %>% slice_min(`Mean_GPD_spent`, n = 5)
governmentEducationExpenditure_minmax <- rbind(governmentEducationExpenditure_valmin, governmentEducationExpenditure_valmax)
governmentEducationExpenditure_minmax$Country <- factor(governmentEducationExpenditure_minmax$Country, levels = governmentEducationExpenditure_minmax$Country[order(governmentEducationExpenditure_minmax$`Mean_GPD_spent`)])
pays_h1_death <- select(annualdeath,Country,Year,`Infectious diseases prop (%)`) %>% filter(Country %in% c("Cuba","Denmark",  "Djibouti", "Lesotho","Norway","Monaco", "Sudan", "Dominican Republic" , "Central African Republic","Cambodia"))
pays_h1_death_mean <- pays_h1_death %>%
group_by(Country) %>%
summarise(Mean_death_ID = mean(`Infectious diseases prop (%)`))
death_valmax <- pays_h1_death_mean %>% top_n(5, wt = `Mean_death_ID`)
death_valmin <- pays_h1_death_mean %>% slice_min(`Mean_death_ID`, n = 5)
death_minmax <- rbind(death_valmin, death_valmax)
death_minmax$Country <- factor(death_minmax$Country, levels = death_minmax$Country[order(death_minmax$`Mean_death_ID`)])
ggplot(governmentEducationExpenditure_minmax, aes(x= Country, y= `Mean_GPD_spent`)) + geom_bar(stat = "identity") + labs(title="Education Expenditure compared to total GDP per country", x="Country", y="mean GPD spent in Education (%)") + scale_y_continuous(limits = c(0, NA), breaks = pretty_breaks(n = 10), labels = comma_format()) + scale_fill_discrete(name = "Country") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(death_minmax, aes(x= Country, y= `Mean_death_ID`)) + geom_bar(stat = "identity") + labs(title="Infectious diseases per total number of death(10 countries education exp", x="Country", y="mean death by Infectious diseases (%)") +  scale_y_continuous(limits = c(0, NA), breaks = pretty_breaks(n = 10),labels = comma_format()) + scale_fill_discrete(name = "Country") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
enrolmentratio_mean <- enrolment_ratio_teritiary_education %>%
group_by(Country) %>%
summarise(Enrolment_ratio = mean(`Enrolment ratio (%)`))
enrolmentratio_mean <- enrolmentratio_mean %>% filter(Enrolment_ratio > 0.1)
enrolmentratio_valmax <- enrolmentratio_mean %>% top_n(5, wt = Enrolment_ratio)
enrolmentratio_valmin <- enrolmentratio_mean %>% slice_min(Enrolment_ratio, n = 5)
enrolmentratio_minmax <- rbind(enrolmentratio_valmin, enrolmentratio_valmax)
enrolmentratio_minmax$Country <- factor(enrolmentratio_minmax$Country, levels = enrolmentratio_minmax$Country[order(enrolmentratio_minmax$Enrolment_ratio)])
ggplot(enrolmentratio_minmax, aes(x= Country, y= `Enrolment_ratio`)) + geom_bar(stat = "identity") + labs(title="mean enrolment ratio per country", x="Country", y="mean enrolment ratio (%)") + scale_y_continuous(limits = c(0, NA), breaks = pretty_breaks(n = 10), labels = comma_format()) + scale_fill_discrete(name = "Country") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
pays_h2_death <- select(annualdeath,Country,Year,`Infectious diseases prop (%)`) %>% filter(Country %in% c("Sao Tome and Principe","Malawi" ,"Tanzania","Saint Vincent and the Grenadines","Niger","Australia","Canada","Finland", "North Korea","United States"))
pays_h2_death_mean <- pays_h2_death %>%
group_by(Country) %>%
summarise(Mean_death_ID = mean(`Infectious diseases prop (%)`))
death_valmax2 <- pays_h2_death_mean %>% top_n(5, wt = `Mean_death_ID`)
death_valmin2 <- pays_h2_death_mean %>% slice_min(`Mean_death_ID`, n = 5)
death_minmax2 <- rbind(death_valmin2, death_valmax2)
death_minmax2$Country <- factor(death_minmax2$Country, levels = death_minmax2$Country[order(death_minmax2$`Mean_death_ID`)])
ggplot(death_minmax2, aes(x= Country, y= `Mean_death_ID`)) + geom_bar(stat = "identity") + labs(title="Infectious diseases per total number of death(10 countries mean enrolment", x="Country", y="mean death by Infectious diseases (%)") +  scale_y_continuous(limits = c(0, NA), breaks = pretty_breaks(n = 10),labels = comma_format()) + scale_fill_discrete(name = "Country") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
waterAcess_mean <- waterAccess %>%
group_by(Country) %>%
summarise(water_access = mean(`Water withdrawal per capita ()`))
waterAcess_mean <- waterAcess_mean %>% filter(water_access > 0.1)
waterAcess_valmax <- waterAcess_mean %>% top_n(5, wt = water_access)
waterAcess_valmin <- waterAcess_mean %>% slice_min(water_access, n = 5)
waterAcess_minmax <- rbind(waterAcess_valmin, waterAcess_valmax)
waterAcess_minmax$Country <- factor(waterAcess_minmax$Country, levels = waterAcess_minmax$Country[order(waterAcess_minmax$water_access)])
ggplot(waterAcess_minmax, aes(x= Country, y= `water_access`)) + geom_bar(stat = "identity") + labs(title="mean water withdrawal per capita (m³) per country ", x="Country", y="mean water withdrawal per capita (m³)") + scale_y_continuous(limits = c(0, NA), breaks = pretty_breaks(n = 10), labels = comma_format()) + scale_fill_discrete(name = "Country") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
pays_h3_death <- select(annualdeath,Country,Year,`Infectious diseases prop (%)`) %>% filter(Country %in% c("Denmark","Monaco","United Kingdom","Cyprus","Sweden","Estonia","Hungary","Japan" ,"Libya","Spain"))
pays_h3_death_mean <- pays_h3_death %>%
group_by(Country) %>%
summarise(Mean_death_ID = mean(`Infectious diseases prop (%)`))
death_valmax3 <- pays_h3_death_mean %>% top_n(5, wt = `Mean_death_ID`)
death_valmin3 <- pays_h3_death_mean %>% slice_min(`Mean_death_ID`, n = 5)
death_minmax3 <- rbind(death_valmin3, death_valmax3)
death_minmax3$Country <- factor(death_minmax3$Country, levels = death_minmax3$Country[order(death_minmax3$`Mean_death_ID`)])
ggplot(death_minmax3, aes(x= Country, y= `Mean_death_ID`)) + geom_bar(stat = "identity") + labs(title="Infectious diseases per total number of death(10 countries mean water withdrawal", x="Country", y="mean death by Infectious diseases (%)") +  scale_y_continuous(limits = c(0, NA), breaks = pretty_breaks(n = 10),labels = comma_format()) + scale_fill_discrete(name = "Country") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
cleanWater_mean <- cleanWater %>%
group_by(Country) %>%
summarise(`Proportion of population unable to access clean water (%)` = mean(`Proportion of population unable to access clean water (%)`))
cleanWater_max <- cleanWater_mean %>% top_n(wt = `Proportion of population unable to access clean water (%)`, n = 10)
cleanWater_min <- cleanWater_mean %>% slice_min(`Proportion of population unable to access clean water (%)`, n = 10) %>% slice_head(n = 10)
cleanWater_minmax <- rbind(cleanWater_min, cleanWater_max)
cleanWater_minmax$Country <- factor(cleanWater_minmax$Country, levels = cleanWater_minmax$Country[order(cleanWater_minmax$`Proportion of population unable to access clean water (%)`)])
ggplot(cleanWater_minmax, aes(x= Country, y=`Proportion of population unable to access clean water (%)`)) + geom_bar(stat = "identity") + labs(title="Proportion de la population n'ayant pas accès à l'eau courante", x="Pays", y="Proportion (en %)") + scale_fill_discrete(name = "Country") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ProportionCleanWater <- merge(cleanWater_minmax, annualdeath[c("Country", "Infectious diseases prop (%)")], by = "Country")
ProportionCleanWater <- ProportionCleanWater %>% group_by(Country) %>% summarize(`Infectious diseases %` = mean(`Infectious diseases prop (%)`), `Proportion of population unable to access clean water (%)` = mean(`Proportion of population unable to access clean water (%)`))
ggplot(ProportionCleanWater, aes(x= Country, y=`Infectious diseases %`)) + geom_bar(stat = "identity") + labs(title="Proportion de personnes mortes de maladies infectieuses", x="Pays", y="Quantité (en %)") + scale_y_continuous(labels = comma_format()) + scale_fill_discrete(name = "Country") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
Polluants_mean <- airPollution %>%
group_by(Country) %>%
summarise(Polluants = sum(`Polluants`))
Polluants_max <- Polluants_mean %>% top_n(10, wt = `Polluants`)
Polluants_min <- Polluants_mean %>% slice_min(`Polluants`, n = 10)
Polluants_minmax <- rbind(Polluants_min, Polluants_max)
Polluants_minmax$Country <- factor(Polluants_minmax$Country, levels = Polluants_minmax$Country[order(Polluants_minmax$Polluants)])
ggplot(Polluants_minmax, aes(x= Country, y= Polluants)) + geom_bar(stat = "identity") + labs(title="Somme des gaz toxiques polluants émis de 1990 à 2010 (en t)", x="Pays", y="Quantité (en t)") + scale_y_log10(breaks = 10^(0:9), labels = comma_format()) + scale_fill_discrete(name = "Country") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ProportionPolluants <- merge(Polluants_minmax, annualdeath[c("Country", "Infectious diseases prop (%)")], by = "Country")
ProportionPolluants <- ProportionPolluants %>% group_by(Country) %>% summarize(`Infectious diseases %` = mean(`Infectious diseases prop (%)`), `Polluants` = mean(`Polluants`))
ggplot(ProportionPolluants, aes(x= Country, y=`Infectious diseases %`)) + geom_bar(stat = "identity") + labs(title="Proportion de personnes mortes de maladies infectieuses", x="Pays", y="Quantité (en %)") + scale_y_continuous(labels = comma_format()) + scale_fill_discrete(name = "Country") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
medics <- medics %>% filter(X < 2011) %>% filter(row_number() %% 2 == 1)
